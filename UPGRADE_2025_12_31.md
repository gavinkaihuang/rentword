
# 升级说明 (2025-12-31)

### 1. 获取最新代码
在服务器上拉取最新的代码：
```bash
git pull
```

### 2. 更新依赖 (可选)
虽然本次没有新增第三方库，但建议检查更新：
```bash
npm install
```

### 3. 数据库迁移 (重要)
本次更新修改了数据库结构，增加了 `UserProgress` 表的 `isUnfamiliar` 字段。
**请务必执行以下命令：**

```bash
# 生成最新的 Prisma Client
npx prisma generate

# 同步数据库结构
# 由于您的服务器数据库可能未建立迁移基线(Baseline)，推荐使用 db push 直接同步结构。
# 这是一个非破坏性操作（新增字段），通常是安全的。
npx prisma db push

# (备选) 仅当您严格遵循迁移流时使用：
# npx prisma migrate deploy
```

> **注意**: 如果 `prisma migrate deploy` 遇到问题，可以尝试 `npx prisma db push`，但请先备份数据库 `prisma/dev.db`。

### 4. 构建应用
重新编译 Next.js 应用：
```bash
npm run build
```

### 5. 重启服务
根据你的部署方式重启服务。

如果是使用 PM2:
```bash
pm2 restart rentword
```

如果是直接运行:
请终止当前进程并重新运行 `npm start`。

---

### 更新内容摘要
- **功能**: 新增“不熟悉单词”标记功能（Learn/Calendar/Select 界面）。
- **功能**: 新增“不熟悉单词”专项学习模式 (Dashboard -> Unfamiliar Words)。
- **修复**: 修复了 Calendar 界面状态不显示的问题。
- **安全**: 更新了中间件，修复了 API 权限验证问题 (`/api/words`)。
